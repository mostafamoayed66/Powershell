# Quick colorful network overview

$statusColor = @{ "Up" = "Green"; "Disconnected" = "Red"; "Disabled" = "DarkGray" }

Get-NetAdapter | Sort Status,Name | ForEach-Object {
    $color = if ($statusColor.ContainsKey($_.Status)) { $statusColor[$_.Status] } else { "White" }
    Write-Host "$($_.Name.PadRight(28)) " -NoNewline -ForegroundColor $color
    Write-Host "$($_.Status.PadRight(14)) " -NoNewline -ForegroundColor $color
    Write-Host "$($_.LinkSpeed.PadRight(12)) " -NoNewline
    Write-Host "$($_.InterfaceDescription)" -ForegroundColor DarkGray
}

Write-Host "nPublic IP: " -NoNewline -ForegroundColor Yellow
try { (Invoke-RestMethod -Uri "https://api.ipify.org" -TimeoutSec 5) } catch { "N/A" }

Write-Host "nListening ports count: " -NoNewline
(Get-NetTCPConnection | Where-Object State -eq Listen).Count
